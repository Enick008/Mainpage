<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Å‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      background-color: #f8fbff;
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in-out both;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .menu-item {
      padding: 1rem;
      border-radius: 1rem;
      font-size: 1.125rem;
      display: block;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .menu-item:hover {
      transform: scale(1.02);
      opacity: 0.9;
    }
  </style>
</head>
<body class="text-gray-800">

<header class="bg-gradient-to-r from-blue-900 to-blue-600 text-white p-6 shadow-md">
  <div class="flex justify-between items-center flex-wrap">
    <div class="flex items-center gap-4">
      <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏°‡∏ß‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ó‡∏ô‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô -->
      <div class="flex flex-col items-center gap-1">
        <img src="https://pic.in.th/image/%E2%80%94Pngtree%E2%80%94cute-cartoon-cat-construction-worker-19844690.SJz5BL"
             alt="‡πÅ‡∏°‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•"
             class="w-20 h-20 rounded-full object-cover shadow-lg bg-white mb-2">
        <div class="text-base font-semibold text-pink-200 drop-shadow">‡πÅ‡∏°‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•</div>
      </div>
      <div>
        <h1 class="text-2xl font-bold">‡∏Å‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•</h1>
        <p class="text-md">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå</p>
      </div>
    </div>
    <div class="text-sm text-right mt-4 sm:mt-0">
      <span id="currentDate" class="block mb-1"></span>
      <button onclick="logout()" class="bg-white text-blue-700 px-4 py-2 rounded-xl shadow hover:bg-gray-100 transition flex items-center gap-1">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
  </div>
</header>


<div class="flex h-[calc(100vh-140px)]">
  <!-- Sidebar Menu -->
  <aside class="w-full sm:w-1/4 lg:w-1/5 bg-white border-r p-4 overflow-y-auto">
    <div class="flex flex-col gap-4">
      <!-- (‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) -->
      <a onclick="comingSoon()" class="menu-item" style="background-color: #ffe0f0">üìÑ ‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ì</a>
      <a href="https://procurement-system.netlify.app/" target="_blank" class="menu-item" style="background-color: #e0ffe6">üì¶ ‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏™‡∏î‡∏∏‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏±‡∏î‡∏à‡πâ‡∏≤‡∏á</a>
      <a onclick="comingSoon()" class="menu-item" style="background-color: #e0f7ff">üóìÔ∏è ‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</a>
      <a onclick="comingSoon()" class="menu-item" style="background-color: #fff0d9">üîß ‡∏Ñ‡∏≥‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ó‡πà‡∏≠</a>
      <a href="https://samuisanitary.my.canva.site/dagnspoefkq" target="_blank" class="menu-item" style="background-color: #fce5cd">üöõ ‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏î‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏è‡∏¥‡∏Å‡∏π‡∏•</a>
      <a href="https://script.google.com/macros/s/AKfycbz4WEybrmLGV4omkDMBqWX765GB8ySYR3fXbUoRqVg/dev" target="_blank" class="menu-item" style="background-color: #e5d0ff">üöΩ ‡∏£‡∏ñ‡∏™‡∏∏‡∏Ç‡∏≤‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà</a>
      <a href="https://samuisanitary.my.canva.site/dagnayggh8g" target="_blank" class="menu-item" style="background-color: #d9f2ff">üï≥Ô∏è ‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ù‡∏≤‡∏ó‡πà‡∏≠</a>
      <a onclick="comingSoon()" class="menu-item" style="background-color: #fff3cd">üì¢ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</a>
      <a href="https://samuiproject.netlify.app/" target="_blank" class="menu-item" style="background-color: #daf7dc">üì• ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î/‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡πà‡∏£</a>
      <a href="https://workassign.netlify.app/" target="_blank" class="menu-item" style="background-color: #f0e68c">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</a>
      <a href="https://script.google.com/macros/s/AKfycbz72aLIWtxS1vIAcvcxL86ukegVFEQVZduCQnc5-RInAHJm63z3luKuVR91m7ewOFGa/exec" target="_blank" class="menu-item" style="background-color: #d9ead3">‚ôªÔ∏è ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Ç‡∏¢‡∏∞</a>
      <a href="https://fixcarsamui.netlify.app/" target="_blank" class="menu-item" style="background-color: #ffdfba">üõ†Ô∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</a>
      <a href="https://app.smartway.co.th/login.php" target="_blank" class="menu-item" style="background-color: #e6f0fa">üöó ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏ñ</a>
    </div>
  </aside>

  <!-- Content Area: ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ç‡πà‡∏≤‡∏ß -->
  <section class="flex-1 p-6 overflow-y-auto">
    <div class="mb-6">
      <h2 class="text-xl font-bold mb-3 text-blue-800">üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ç‡πà‡∏≤‡∏ß</h2>
      <form id="newsForm" class="flex flex-col sm:flex-row gap-2 items-start mb-4">
        <input type="date" id="newsDate" class="border rounded px-2 py-1" required>
        <input type="text" id="newsText" class="border rounded px-2 py-1 flex-1" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®..." required>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700" id="newsSubmitBtn">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
      </form>
      <ul id="newsList" class="space-y-2"></ul>
    </div>
  </section>
</div>

<footer class="bg-blue-900 text-white text-center py-4 mt-auto">
  <div class="text-sm">¬© 2025 ‡∏Å‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏• ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•‡∏ô‡∏Ñ‡∏£‡πÄ‡∏Å‡∏≤‡∏∞‡∏™‡∏°‡∏∏‡∏¢ ‡πÇ‡∏î‡∏¢ ‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏û‡∏π‡∏•‡πÄ‡∏Ç‡∏≤‡∏•‡πâ‡∏≤‡∏ô</div>
</footer>

<!-- Coming Soon Modal -->
<div id="comingSoonModal" class="fixed inset-0 bg-black bg-opacity-40 hidden items-center justify-center z-50">
  <div class="bg-white p-6 rounded-xl shadow-xl text-center max-w-sm w-full">
    <div class="text-5xl mb-4">‚è≥</div>
    <h2 class="text-xl font-semibold mb-2">‡∏≠‡∏î‡πÉ‡∏à‡∏£‡∏≠‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞</h2>
    <p class="text-sm mb-4">‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
    <button onclick="hideComingSoon()" class="bg-blue-600 text-white px-4 py-2 rounded-xl hover:bg-blue-700">‡∏õ‡∏¥‡∏î</button>
  </div>
</div>

<script>
  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Escape HTML
  function escapeHTML(str) {
    return String(str)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/'/g, "&#39;")
      .replace(/"/g, "&quot;");
  }

  // ‡πÉ‡∏™‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô)
  function getTodayDate() {
    const d = new Date();
    const month = (d.getMonth() + 1).toString().padStart(2, '0');
    const day = d.getDate().toString().padStart(2, '0');
    return `${d.getFullYear()}-${month}-${day}`;
  }

  document.getElementById('currentDate').textContent = new Date().toLocaleDateString('th-TH', {
    year: 'numeric', month: 'long', day: 'numeric'
  });

  function logout() {
    localStorage.removeItem('loggedIn');
    location.reload();
  }

  function comingSoon() {
    const modal = document.getElementById('comingSoonModal');
    modal.classList.remove('hidden');
    modal.classList.add('flex');
  }

  function hideComingSoon() {
    const modal = document.getElementById('comingSoonModal');
    modal.classList.add('hidden');
    modal.classList.remove('flex');
  }

  // =========================
  // ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡πà‡∏≤‡∏ß ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Google Sheets
  // =========================
  const API_URL = "https://script.google.com/macros/s/AKfycbyUBo00IJyYOd8jNiL-IMnYU6nB-4zvRHoPNBz4aRVNAILG8BM6v-8N4N9ck7hELAhuyg/exec";
  let editingId = null;

  // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
  if (document.getElementById('newsDate')) {
    document.getElementById('newsDate').value = getTodayDate();
  }

  async function fetchNews() {
    try {
      const res = await fetch(`${API_URL}?action=getNews`);
      const data = await res.json();
      return data.news || [];
    } catch (e) {
      document.getElementById('newsList').innerHTML = `<li class="text-red-500">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πà‡∏≤‡∏ß</li>`;
      return [];
    }
  }

  async function renderNews() {
    const ul = document.getElementById('newsList');
    ul.innerHTML = `<li class="text-gray-400">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</li>`;
    const news = await fetchNews();
    if (!news.length) {
      ul.innerHTML = `<li class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</li>`;
      return;
    }
    ul.innerHTML = news.slice().reverse().map(item => `
      <li class="bg-white p-4 rounded-xl shadow fade-in flex flex-col sm:flex-row gap-2 justify-between items-start sm:items-center">
        <div>
          <span class="font-semibold text-blue-600">${escapeHTML(item.date)}:</span> ${escapeHTML(item.text)}
        </div>
        <div class="flex gap-2">
          <button onclick="startEditNews('${escapeHTML(item.id)}', '${escapeHTML(item.date)}', '${escapeHTML(item.text)}')" class="text-yellow-600 hover:underline">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button onclick="deleteNews('${escapeHTML(item.id)}')" class="text-red-600 hover:underline">‡∏•‡∏ö</button>
        </div>
      </li>
    `).join('');
  }

  async function addNews(e) {
    e.preventDefault();
    const date = document.getElementById('newsDate').value;
    const text = document.getElementById('newsText').value.trim();
    if (!date || !text) return;

    let url = `${API_URL}?action=addNews&date=${encodeURIComponent(date)}&text=${encodeURIComponent(text)}`;
    let method = 'GET';

    if (editingId) {
      url = `${API_URL}?action=editNews&id=${encodeURIComponent(editingId)}&date=${encodeURIComponent(date)}&text=${encodeURIComponent(text)}`;
      method = 'GET';
    }

    const resp = await fetch(url, { method });
    const result = await resp.json();
    if (!result.success) {
      alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (result.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πà‡∏≤‡∏ß‡πÑ‡∏î‡πâ'));
    }

    document.getElementById('newsForm').reset();
    document.getElementById('newsDate').value = getTodayDate();
    editingId = null;
    document.getElementById('newsSubmitBtn').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°';
    renderNews();
  }

  async function deleteNews(id) {
    if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡πâ?')) return;
    await fetch(`${API_URL}?action=deleteNews&id=${encodeURIComponent(id)}`);
    renderNews();
  }

  function startEditNews(id, date, text) {
    document.getElementById('newsDate').value = date;
    document.getElementById('newsText').value = text;
    editingId = id;
    document.getElementById('newsSubmitBtn').textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
    document.getElementById('newsText').focus();
  }

  document.getElementById('newsForm').onsubmit = addNews;
  window.startEditNews = startEditNews;
  window.deleteNews = deleteNews;

  // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πà‡∏≤‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
  renderNews();
</script>

</body>
</html>
